<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Malla Curricular Medicina</title>
<style>
body{
  font-family: "Poppins", sans-serif;
  background:#f6f5fa;
  margin:0;
  padding:20px;
}
h1,h2{
  text-align:center;
}
.progress-container{
  width:80%;
  margin:20px auto;
}
.progress-bar{
  width:100%;
  height:20px;
  background:#ddd;
  border-radius:20px;
  overflow:hidden;
}
.progress{
  height:100%;
  background:linear-gradient(90deg,#a18cd1,#fbc2eb);
  width:0%;
  transition:.5s;
}
#percentage{
  text-align:center;
  margin-top:8px;
  font-weight:bold;
}
.periodo{
  margin:30px 0;
}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
  gap:15px;
}
.card{
  padding:15px;
  border-radius:18px;
  background:#eee;
  cursor:pointer;
  box-shadow:0 8px 18px rgba(0,0,0,.08);
  transition:.3s;
}
.card:hover{
  transform:scale(1.03);
}
.aprobada{
  background:#b9fbc0;
}
.disponible{
  background:#d7c7ff;
}
.bloqueada{
  background:#e0e0e0;
  cursor:not-allowed;
}
.laboratorio{
  background:#cce5ff;
}
.modulo{
  background:#ffd6e8;
}
small{
  display:block;
  opacity:.7;
}
</style>
</head>

<body>

<h1>ðŸ©º Malla Curricular â€“ Medicina</h1>

<div class="progress-container">
  <div class="progress-bar">
    <div class="progress" id="progress"></div>
  </div>
  <div id="percentage">0%</div>
</div>
<div id="malla"></div>
<h2>ðŸ§ª Laboratorios</h2>
<div id="laboratorios" class="grid"></div>
<h2>ðŸ“¦ MÃ³dulos</h2>
<div id="modulos" class="grid"></div>
<script>
const materias = [
  {id:"BG101",nombre:"BiologÃ­a I",periodo:1,req:[],tipo:"materia"},
  {id:"QM101",nombre:"QuÃ­mica I",periodo:1,req:[],tipo:"materia"},
  {id:"QM206",nombre:"QuÃ­mica OrgÃ¡nica",periodo:2,req:["QM101"],tipo:"materia"},
  {id:"QM301",nombre:"BioquÃ­mica",periodo:3,req:["QM206"],tipo:"materia"},
  {id:"BG206",nombre:"EmbriologÃ­a",periodo:4,req:["BG101"],tipo:"materia"},
  {id:"MD304",nombre:"HistologÃ­a",periodo:5,req:["BG206"],tipo:"materia"},
  {id:"MD409",nombre:"AnatomÃ­a I",periodo:5,req:["QM301"],tipo:"materia"},
  {id:"MD410",nombre:"AnatomÃ­a II",periodo:6,req:["MD409","MD304"],tipo:"materia"},
  {id:"MD411",nombre:"NeuroanatomÃ­a I",periodo:5,req:["BG206"],tipo:"materia"},
  {id:"MD412",nombre:"NeuroanatomÃ­a II",periodo:6,req:["MD411"],tipo:"materia"},
  {id:"MD511",nombre:"FisiologÃ­a I",periodo:7,req:["MD410","MD412"],tipo:"materia"},
  {id:"MD512",nombre:"FisiologÃ­a II",periodo:8,req:["MD511"],tipo:"materia"},
  {id:"MD610",nombre:"FisiopatologÃ­a I",periodo:9,req:["MD512"],tipo:"materia"},
  {id:"MD611",nombre:"FisiopatologÃ­a II",periodo:10,req:["MD610"],tipo:"materia"},

  {id:"LAB_ANAT",nombre:"Laboratorio AnatomÃ­a",req:["MD409"],tipo:"laboratorio"},
  {id:"LAB_NEURO",nombre:"Laboratorio NeuroanatomÃ­a",req:["MD411"],tipo:"laboratorio"},

  {id:"MOD_ING",nombre:"MÃ³dulo InglÃ©s",req:[],tipo:"modulo"},
  {id:"MOD_DH",nombre:"MÃ³dulo Derechos Humanos",req:[],tipo:"modulo"}
];

let aprobadas = JSON.parse(localStorage.getItem("aprobadas")) || [];

function puede(m){
  return m.req.every(r=>aprobadas.includes(r));
}

function toggle(id){
  if(aprobadas.includes(id)){
    aprobadas = aprobadas.filter(x=>x!==id);
  }else{
    aprobadas.push(id);
  }
  localStorage.setItem("aprobadas",JSON.stringify(aprobadas));
  render();
}

function render(){
  document.getElementById("malla").innerHTML="";
  document.getElementById("laboratorios").innerHTML="";
  document.getElementById("modulos").innerHTML="";

  const periodos=[...new Set(materias.filter(m=>m.periodo).map(m=>m.periodo))];

  periodos.forEach(p=>{
    const div=document.createElement("div");
    div.className="periodo";
    div.innerHTML=`<h2>Periodo ${p}</h2><div class="grid"></div>`;
    const grid=div.querySelector(".grid");

    materias.filter(m=>m.periodo===p).forEach(m=>{
      const c=document.createElement("div");
      c.className="card";
      if(aprobadas.includes(m.id)) c.classList.add("aprobada");
      else if(puede(m)) c.classList.add("disponible");
      else c.classList.add("bloqueada");

      c.innerHTML=`<strong>${m.nombre}</strong><small>${m.id}</small>`;
      if(puede(m)) c.onclick=()=>toggle(m.id);
      grid.appendChild(c);
    });

    document.getElementById("malla").appendChild(div);
  });

  materias.filter(m=>m.tipo==="laboratorio").forEach(m=>{
    const c=document.createElement("div");
    c.className="card laboratorio";
    if(aprobadas.includes(m.id)) c.classList.add("aprobada");
    else if(!puede(m)) c.classList.add("bloqueada");
    c.innerHTML=`<strong>${m.nombre}</strong>`;
    if(puede(m)) c.onclick=()=>toggle(m.id);
    document.getElementById("laboratorios").appendChild(c);
  });

  materias.filter(m=>m.tipo==="modulo").forEach(m=>{
    const c=document.createElement("div");
    c.className="card modulo";
    if(aprobadas.includes(m.id)) c.classList.add("aprobada");
    c.innerHTML=`<strong>${m.nombre}</strong>`;
    c.onclick=()=>toggle(m.id);
    document.getElementById("modulos").appendChild(c);
  });

  const total=materias.length;
  const pct=Math.round((aprobadas.length/total)*100);
  document.getElementById("progress").style.width=pct+"%";
  document.getElementById("percentage").innerText=pct+"% completado";
}

render();
</script>

</body>
</html>
